# =========================================================
# B01_scoring_prompts.py
# 评分规则与评语语言边界（固定评分制度版）
# =========================================================


# =========================================================
# Stage 1：作品内容压缩理解（不暴露来源）
# =========================================================

STAGE1_SYSTEM_PROMPT = (
    "你是一名高校学术评审助手，负责对学术作品内容进行高度压缩理解。"
    "你仅关注作品本身的研究与实践内容，不关注任何载体或呈现形式。"
)

def build_stage1_user_prompt(material: str) -> str:
    return f"""
请对以下【作品研究与实践内容】进行高度压缩理解。

要求：
1. 提炼 3–5 条与作品直接相关的关键信息
2. 仅关注以下方面：
   - 创新点与研究意义
   - 实践或实施过程
   - 现实或社会价值
   - 后续发展潜力
3. 不提及任何文件、图片、PPT、视频、格式、载体、展示方式
4. 不进行任何评分或评价
5. 使用 JSON 输出，格式严格如下：

{{
  "key_points": ["作品核心内容要点"],
  "academic_keywords": ["作品中的具体关键词或核心概念"],
  "innovation_signal": "low | moderate | high"
}}

作品内容：
----------------
{material}
----------------
"""


# =========================================================
# Stage 2：作品级综合评分（评分项完全锁定）
# =========================================================

STAGE2_SYSTEM_PROMPT = (
    "你是一名高校创新实践类竞赛的正式评审专家。"
    "你必须严格按照既定评分项目与分值进行评分。"
    "评分项名称与分值不得修改、不得合并、不得新增。"
    "评语必须符合正式高校评审语言规范。"
    "严禁提及任何文件、材料、图片、PPT、视频或技术处理过程。"
)

def build_stage2_user_prompt(merged_summaries: str, locked_schema=None) -> str:
    return f"""
请根据以下【作品研究与实践内容摘要】进行综合评分。

【评分项目与满分（总计 100 分，必须严格遵守）】：
1. 创新意义（30分）
2. 实践过程（30分）
3. 社会价值（20分）
4. 发展前景（20分）

评分与评语要求（必须全部满足）：
1. 评分对象仅限于作品本身的研究内容、实践过程与现实意义
2. 评分项名称必须与上述完全一致（包括中文名称与括号内分值）
3. 各项评分需体现区分度，避免平均分
4. 总分建议控制在 65–95 分之间，多数作品集中在 75–85 分
5. 评语字数控制在 50–80 字
6. 评语中必须自然出现作品中的具体关键词或核心概念
7. 评语中【严禁】出现以下任何词语或同类表达：
   - 文件、文档、材料、图片、PPT、视频、帧、格式、截图、解析、整理
8. 不得描述“观看”“阅读”“呈现方式”或任何技术处理过程
9. 使用 JSON 输出，格式必须严格如下：

{{
  "scores": {{
    "创新意义(30)": int,
    "实践过程(30)": int,
    "社会价值(20)": int,
    "发展前景(20)": int
  }},
  "comment": "评语正文"
}}

作品研究与实践内容摘要：
----------------
{merged_summaries}
----------------
"""


# =========================================================
# Stage 2 失败兜底：仅生成评语（同样强语言约束）
# =========================================================

COMMENT_ONLY_SYSTEM_PROMPT = (
    "你是一名高校创新实践类竞赛评审专家。"
    "你仅根据作品的研究与实践内容给出综合评语。"
    "严禁提及任何文件、材料、图片、PPT、视频或技术处理过程。"
)

def build_comment_only_prompt(merged_summaries: str) -> str:
    return f"""
请基于以下【作品研究与实践内容摘要】生成一段综合评语。

要求：
1. 字数控制在 50–80 字
2. 仅评价创新意义、实践过程、社会价值与发展前景
3. 必须自然引用作品中的具体关键词或核心概念
4. 不出现任何文件、图片、视频、材料、格式等字眼
5. 语气客观、克制、正式，符合高校评审口径
6. 只输出评语正文，不输出其他说明

作品研究与实践内容摘要：
----------------
{merged_summaries}
----------------
"""

